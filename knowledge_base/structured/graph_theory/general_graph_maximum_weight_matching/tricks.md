- **使用边权乘2避免浮点数误差**：在计算 `z_e` 时，将所有边权乘以2，使顶标调整过程中的除法变为整数运算。
- **缩花（Blossom Contraction）**：遇到奇环时将其缩为一个“花”节点，并维护 `flower[b]` 记录花中包含的点和子花。花可以嵌套。
- **顶标（Vertex Labeling）与等边**：定义 `z_u` 为顶标，边 `(u,v)` 是等边当且仅当 `z_u + z_v == w(u,v)`。算法始终在等边上进行增广。
- **Slack 边优化**：用 `slack[x]` 维护从当前交错树到外部点 `x` 的最小 `z_e` 值，避免每次遍历所有边。
- **EXPAND 拆花时机**：当一朵奇花 `b` 的 `z_B == 0` 时必须拆开，以维持对偶可行性，并恢复潜在的增广路径。
- **LCA 判定花结构**：使用静态时间戳技巧高效求出两节点在交错树上的最近公共祖先，判断是否形成新花。
- **多棵树并行 BFS**：初始将所有未匹配点加入队列，允许多棵交错树同时生长，提高效率。
- **flower_from 数组维护嵌套关系**：`flower_from[b][x]` 记录花 `b` 中包含点 `x` 的最内层子花或点，用于正确传递匹配信息。
- **顶标调整策略**：同时考虑三类增量 `d1`（树内外）、`d2`（不同树间偶点）、`d3`（奇花），取最小值 `d` 调整顶标，确保生成新的等边。
- **完美匹配转一般匹配**：通过设置初始顶标为最大边权，并允许顶标为0的点成为未匹配点，自然处理非完美情况。