# 再谈图连通性相关算法

**Author:** 虞皓翔

## 关键思想与技巧

### Menger 定理与网络流建模
- **点连通度 κ(u,v)**：通过拆点法将点容量限制转化为边容量限制。每个点 v 拆为 v_in 和 v_out，中间连一条容量为1的边；原无向边 (u,v) 转化为两条有向边 u_out→v_in 和 v_out→u_in。κ(u,v) 即为从 u_out 到 v_in 的最大流。
- **边连通度 λ(u,v)**：直接在原图上求最大流，每条边容量为1。λ(u,v) 即为最大流值。

### 等价流树 (Equivalent-flow Tree)
- **核心思想**：对于所有点对的边连通度查询，无需 O(|V|²) 次最大流。通过递归选取两点 (u,v)，计算其 λ(u,v) 并用最小割将点集划分为 S* 和 T*，然后递归处理 S=S*∩U 和 T=T*∩U。最终构建一棵树，其中任意两点间路径上的最小边权即为它们的 λ(u,v)。
- **Gusfield 算法**：非递归实现，固定一个根 r，依次处理其他点 v，找到已处理集合中与 v 不连通的 u，计算 λ(u,v) 并更新集合划分。复杂度 O(|V| Flow(|V|,|E|))。

### Tarjan 算法求 2-连通分量
- **边双连通分量 (2-edge-connected)**：基于 DFS 树。定义 `low[v]` 为 v 及其子树通过返祖边能到达的最小 dfs 序号。若 `low[v] > id[父节点]`，则 (父节点, v) 是桥边。当 `id[v] == low[v]` 时，以 v 为根的子树构成一个边双连通分量。
- **点双连通分量 (2-vertex-connected)**：同样使用 `low[v]`。若存在子节点 c 满足 `low[c] >= id[v]`，则 v 是割点。利用栈在回溯时收集点双连通分量。关键观察是：属于同一个点双的树边在 DFS 树上形成连通块，且满足 `id[v] <= low[c]` 的边 (v,c) 属于同一分量。

### 圆方树 (Round-Square Tree)
- **结构**：将原图 G 的点双连通分量抽象为“方点”，原图中的点为“圆点”。每个方点与其包含的所有圆点相连。结果是一棵树。
- **应用**：将图上的路径问题（如两点间简单路径数、路径最短长度）转化为树上的路径问题，极大简化处理。

### 3-边连通分量的线性算法
- **切边等价 (Cut-edge equivalence)**：两条边 e1,e2 是切边等价的，当且仅当它们在图中的每一个环里同时出现或同时不出现。这构成一个等价关系。
- **收缩与度为2的点**：
  - 若一条边 e=(u,v) 所在的切边等价类大小为1，则 u,v 在同一个3-边连通分量中，可将 e 收缩（合并 u,v）。
  - 若一个点 v 的度为2，连接 u,w，则 {v} 自成一个3-边连通分量，可删除 v 并添加边 (u,w)。
- **随机化优化**：为每条返祖边分配随机64位权值，定义 `c(e)` 为所有覆盖树边 e 的返祖边权值的异或和。`c(e1)==c(e2)` 高概率意味着 e1,e2 切边等价。用树上差分可在 O(|V|+|E|) 内计算所有 `c(e)`。
- **迭代收缩**：维护一个待处理的边集 A（等价类大小为1）和点集 D（度为2）。不断应用上述两种规则进行收缩或删除，直到无法进行。剩余的连通块即为3-边连通分量。总复杂度 O(|E| α(|V|))。

### SPQR 树 (3-点连通的结构分解)
- **基础**：任意两个3-点连通分量至多共享两个顶点（割点对）。
- **构造**：通过识别割点对 (u,v) 将图沿虚边划分，直到每个部分都是3-点连通的（R型）、圈（S型）或多重边（P型）。
- **树结构**：SPQR 树的节点是这些基本块（S,P,Q,R），边表示它们通过一条公共虚边连接。这棵树是唯一的，可用于高效查询割点对等信息。