- **关键点稀疏时使用**：当每次询问的关键点总数远小于总节点数时，虚树能将复杂度从 $ O(nq) $ 降为 $ O(\sum k_i \log n) $。

- **必须包含所有 LCA**：为了保持原树中的拓扑结构，任意两个关键点的 LCA 必须被加入虚树，否则路径信息会丢失。

- **按 DFS 序排序是核心**：排序后相邻节点的 LCA 覆盖了所有必要的虚点，这是构造正确性的基础。

- **单调栈维护当前链**：利用栈维护当前正在构建的虚树主链，保证父节点关系正确；弹栈时及时连边，避免重复处理。

- **去重与清空邻接表技巧**：在节点入栈前清空其在虚树中的邻接表（如 `head[u] = -1`），避免全局清空带来的高开销。

- **根节点强制加入**：通常将根（如 1 号节点）作为起点加入虚树，不影响答案但简化实现。

- **虚树点数线性**：最多有 $ 2k-1 $ 个节点（$ k $ 关键点 + $ k-1 $ 个 LCA），因此整体复杂度可控。

- **配合树形 DP 使用**：虚树常用于在精简后的结构上运行 DP，排除无关节点干扰，例如最小割、路径合并等场景。