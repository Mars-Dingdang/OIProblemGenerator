# OI 题目中凸性的证明方法

**Author:** 苟竞予

## 规约为常见模型
- **费用流模型**：最小费用最大流中，总费用关于流量是下凸函数（差分单调不降）；最大费用则对应上凸。可通过构建残量网络并添加辅助边，利用增广路径代价递增的性质证明凸性。
- **四边形不等式**：若代价函数 $ w(l, r) $ 满足四边形不等式，则划分问题的 DP 具有决策单调性，且段数相关的答案函数具有凸性（如段数增加时总代价呈上凸/下凸趋势）。可用于 WQS 二分优化。

## 代数方法
- 利用凸函数定义（如中点值不大于端点平均值）或差分序列单调性进行数学归纳或反证。
- 分析函数表达式的结构，例如将离散问题松弛为连续问题以观察趋势（如 $ f^*(a,r) = r \cdot t + k \cdot a^2 / r $），再还原回整数情形。
- 使用半平面交视角：某些分段线性函数可视为多条直线的逐段最大值，若斜率单调递增，则整体为下凸函数。
- 数学归纳法结合差分分析：用于证明 DP 状态的凸性和决策单调性，需同时维护状态值和其差分的单调性。

## 几何方法
- **凸集交仍为凸集**：两个凸图形的交集仍是凸的，因此其在某一方向上的投影长度（如竖直截线长度）关于参数是上凸函数。
- **平移相交区域**：固定宽度 $ w $ 的矩形左右边界形成的平移重叠区是凸多边形，其高度函数 $ h_w(l) $ 是上凸的。
- **利用轮廓函数凸性**：凸多边形上下轮廓是上凸/下凸函数，组合形式（如 $ \min\{u(l), u(l+w)\} - \max\{d(l), d(l+w)\} $）保持上凸性。
- **凸函数的保凸运算**：非负加权和、逐点最大/最小（在特定条件下）、仿射复合等操作保持凸性；乘以正标量也保持凸性方向。

## 关键技巧与观察
- **单谷性源于凸性拼接**：一个函数可能由一段凸函数和一段单调函数拼接而成，形成单谷结构，便于三分查找。
- **渐近分析辅助算法设计**：通过估计函数增长阶（如 $ \Theta(n \log^2 n) $）指导优化策略，如差分序列取值段数有限，可枚举差分值进行倍增验证。
- **打表预处理高复杂度但低输出的问题**：当答案差分变化缓慢（如 $ \Delta f(n) = \Theta(\log^2 n) $），实际不同差分值数量很少，可在本地打表后提交静态数据。