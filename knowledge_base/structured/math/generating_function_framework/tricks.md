# 信息学竞赛中的生成函数计算理论框架

**Author:** 李白天

## 关键思想与技巧

### 1. **生成函数的代数建模**
- 使用**卷积下标系统**统一描述不同类型的卷积（如普通卷积、二项卷积、集合并卷积），通过定义结合、交换、单位元、零元和后效律来形式化运算规则。
- 引入**未定元 $X_i$** 满足 $X_i \cdot X_j = X_{i \circ j}$，将序列卷积转化为生成函数乘法。

### 2. **复合与方程求解方法**
- **牛顿迭代法**：用于求解形如 $F(G) = 0$ 的生成函数方程。通过对下标系统截取（如模 $x^{\lfloor n/2 \rfloor + 1}$），在已知低次项的基础上进行泰勒展开，通常保留一阶项 $F(G) \approx F(G_0) + F'(G_0)(G - G_0)$，转化为线性方程求解。
- **在线算法（Relaxed Algorithm）**：利用**后效序**（$i \preceq j$ 当且仅当存在 $k$ 使得 $i \circ k = j$）设计逐步计算策略。通过优先级函数 $\delta$ 控制计算顺序，确保每次只依赖已知项。特别适用于处理复杂的微分方程或嵌套复合结构。
- **转置原理（Transpose Principle）**：若能高效计算矩阵转置 $M^T y$，则可通过“转置改写”步骤得到原变换 $M x$ 的高效算法。常用于优化导数算子、位移算子等线性变换的实现。

### 3. **Lagrange 反演的强化版本**
- 经典 Lagrange 反演要求 $n$ 在系数环中可逆，限制其在小模数或特征非零环上的使用。
- 提出 **另类 Lagrange 反演**：
  $$[x^n]H(F(x)) = [x^n] H(x) \left(\frac{x}{G(x)}\right)^{n+1} G'(x)$$
  其中 $G$ 是 $F$ 的复合逆。此形式避免除以 $n$，可在任意环上使用，尤其适合模 $p$ 下 $p \mid n$ 的情况。
- 多元推广：基于行列式容斥原理，给出多元树形复合方程的反演公式，应用于图计数问题（如生成树、仙人掌）。

### 4. **高维与集合幂级数优化**
- **高维卷积**：采用**进位占位元**（carry placeholder）技术，定义占位函数 $\chi(i)$ 表示加法中的总进位次数。将多维下标映射为一维并附加 $t^{\chi(i)}$，通过 $\mod (t^k - 1)$ 防止污染，实现 $O(k M(n))$ 的高维卷积。
- **集合幂级数**：视为 $A[x_1,\dots,x_n]/(x_i^2)$ 的多元多项式。使用 **插值转化**（选取 $\alpha_i^{(j)} \in \{0,1\}$）结合占位多项式进行逐点乘法，配合 Möbius 变换实现卷积。
- **全半在线卷积**：通过分治 + 插值，在集合大小顺序下逐个输出结果，支持复杂递推式的实时求解。

### 5. **线性递推的低位优先算法（LSB-first）**
- 将线性递推 $a_n = \sum b_j a_{n-j}$ 转化为生成函数 $P(x)/Q(x)$。
- 利用恒等式：
  $$\frac{P(x)}{Q(x)} = \frac{P(x)Q(-x)}{Q(x)Q(-x)} = \frac{E(x^2) + x O(x^2)}{U(x^2)}$$
  递归计算偶数位和奇数位，每层耗时 $O(M(k))$，共 $\log n$ 层，总复杂度 $O(M(k) \log n)$，优于传统 Fiduccia 算法且常数更优。

### 6. **指数生成函数（EGF）在非可逆环上的处理**
- 当 $n!$ 不可逆时（如模 $p^k$），不能直接转换为普通生成函数。
- 使用 **四模数 NTT** 计算二项卷积：
  - 利用 Kummer 定理，$v_p(\binom{n}{k})$ 等于 $k + (n-k)$ 在 $p$ 进制下加法的进位次数。
  - 构造 $\hat{a}_n = a_n / (n!_p)$，其中 $n!_p$ 是去除 $p$ 因子后的阶乘。
  - 卷积结果被控制在整数范围内，可用多个 NTT 模数计算后 CRT 合并。
- 结合转置原理，可高效实现 $f(x+c)$、$g(D)f(x)$ 等算子作用。

### 7. **Tutte 多项式与图计数统一框架**
- Tutte 多项式 $T_G(x,y)$ 统一了染色数、无环定向、强连通定向等多个经典问题。
- 通过**连通-点双连通变换**（Connected-Biconnected Transform），利用集合幂级数复合与对称复合方程，在 $O(n^2 2^n)$ 时间内枚举所有子图的 Tutte 值，解决仙人掌计数等问题。