## 关键观察
1. **唯一性**：给定 n+1 个点（横坐标互异），存在唯一一个次数不超过 n 的多项式通过所有点。
2. **构造形式**：拉格朗日插值公式为：
   $$f(x) = \sum_{i=0}^{n} y_i \prod_{j\neq i} \frac{x - x_j}{x_i - x_j}$$
   每个基函数 $L_i(x) = \prod_{j\neq i} \frac{x - x_j}{x_i - x_j}$ 满足 $L_i(x_i)=1$，$L_i(x_j)=0$（$j\neq i$）。

## 优化技巧
1. **横坐标为连续整数**：当 $x_i = i$（或 $x_i = a + i$）时，可 $O(n)$ 计算：
   - 预处理前缀积 $pre[i] = \prod_{j=1}^{i} (k-j)$，后缀积 $suf[i] = \prod_{j=i}^{n} (k-j)$。
   - 分母 $\prod_{j\neq i} (i-j)$ 可化为 $(-1)^{n-i} (i-1)! (n-i)!$，预处理阶乘和逆元。
   - 公式：$f(k) = \sum_{i=1}^{n} y_i \cdot \frac{pre[i-1] \cdot suf[i+1]}{(i-1)! (n-i)!} \cdot (-1)^{n-i}$。

2. **自然数幂和**：$\sum_{i=1}^{n} i^k$ 是关于 n 的 k+1 次多项式。可计算前 k+2 个值后插值得到任意 n 的值。

3. **模质数时的逆元**：分母求逆可用费马小定理（$MOD$ 为质数）或扩展欧几里得。

4. **多次求值**：若需求多项式系数，可用文中代码的 $O(n^2)$ 方法（通过 $M(x)=\prod (x-x_i)$ 和 $px_i$ 组合）。

## 常见变换
- **差分与插值**：若问题可转化为多项式求值，且能快速求出多个点值，可用插值。
- **前缀和插值**：前缀和序列可能是多项式，例如 $\sum i^k$ 的前缀和是 k+1 次多项式。
- **平移点值**：已知 $f(a), f(a+1), ..., f(a+n)$，可令 $x_i' = x_i - a$ 转化为连续整数插值。

## 注意事项
- 横坐标必须互异，否则分母为零。
- 模运算中负数需调整到 $[0, MOD)$。
- 当 $k$ 远大于 $n$ 时，直接计算可能溢出，需取模。
- 若多项式次数低于 n，插值结果仍正确，但计算了不必要的高次项。