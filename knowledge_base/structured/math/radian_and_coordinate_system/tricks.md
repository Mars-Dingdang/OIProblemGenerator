## 关键观察与技巧

1. **圆周率常数**：在 C++ 中，使用 `acos(-1.0)` 或 `4 * atan(1.0)` 获得最精确的 π 值。直接写 `3.141592653589793` 也可，但前者更清晰且保证精度。

2. **atan2 函数**：极坐标转换时，**务必使用 `atan2(y, x)`** 而不是 `atan(y/x)`，因为 `atan2` 能正确处理所有象限（返回范围 (-π, π]），避免符号错误。

3. **角度与弧度**：
   - 数学库（`sin`, `cos`, `tan`）默认使用弧度。
   - 转换公式：`弧度 = 角度 * π / 180`，`角度 = 弧度 * 180 / π`。

4. **坐标系定义一致性**：
   - **极坐标**：`(ρ, φ)`，ρ ≥ 0，φ ∈ [0, 2π) 或 (-π, π]。
   - **球坐标**：注意符号约定（天顶角 θ vs 方位角 φ）在不同文献中可能互换，使用时必须明确声明。常用约定：
     - `r`：半径
     - `θ`：天顶角（与 z 轴夹角，0 ≤ θ ≤ π）
     - `φ`：方位角（在 xy 平面内与 x 轴夹角，0 ≤ φ < 2π）
   - 转换公式：
     - `x = r sin θ cos φ`
     - `y = r sin θ sin φ`
     - `z = r cos θ`

5. **柱坐标系**：本质是极坐标 + z 轴，即 `(ρ, φ, z)`，其中 (ρ, φ) 为 xy 平面上的极坐标，z 为高度。

6. **浮点精度**：比较角度/坐标时，使用容差（如 `1e-9`）而非直接相等。

7. **问题转换模式**：
   - **几何旋转**：常将问题转换到极坐标或复数平面处理，旋转对应角度加减。
   - **距离与方向**：导航类问题（如“北偏东 30° 距离 100”）直接使用极坐标建模更自然。
   - **对称性**：在极坐标下，圆形对称问题往往简化（ρ 不变，φ 变化）。
   - **三维投影**：将三维问题投影到二维平面时，可先用球坐标或柱坐标分析再转换。

8. **优化**：
   - 预先计算常用角度的 `sin`/`cos` 值（如 0°, 30°, 45°, 60°, 90° 对应弧度）。
   - 向量化运算：同时处理多个点的坐标转换时，可考虑 SIMD 或并行化。

9. **常见陷阱**：
   - 角度制与弧度制混用导致错误。
   - 使用 `atan(y/x)` 丢失象限信息。
   - 球坐标中 θ 和 φ 的定义混淆。
   - 未处理 ρ = 0（极点）的特殊情况（此时 φ 未定义）。