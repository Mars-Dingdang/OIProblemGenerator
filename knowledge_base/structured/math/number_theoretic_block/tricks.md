## 关键观察
- **块的数量**：对于 n，不同 ⌊n/i⌋ 的取值只有 O(√n) 个，具体上界为 2√n，精确公式为 |D(n)| = ⌊√(4n+1)⌋ - 1。
- **块的端点**：对于当前左端点 l，右端点 r = ⌊n / ⌊n/l⌋⌋。
- **对称性**：图像关于 y = x 对称，块的右端点集合就是 D(n)。

## 优化技巧
1. **预处理前缀和**：如果 f 的前缀和可以 O(1) 查询（如预处理或公式已知），则总复杂度为 O(√n)。
2. **递归性质**：D(m) ⊆ D(n) 对于 m ∈ D(n)，这在杜教筛等递归算法中很有用。

## 扩展模式
- **向上取整**：⌈n/i⌉ = ⌊(n-1)/i⌋ + 1，可转化为向下取整处理。
- **多维分块**：对于形如 ∑ f(i) g(⌊n₁/i⌋, ⌊n₂/i⌋, ...) 的和式，右端点取各维右端点的最小值：r = min{⌊nⱼ / ⌊nⱼ/l⌋⌋}。
- **任意指数**：处理 ⌊n^α / i^β⌋ 时，块数为 O(n^{α/(1+β)})，右端点公式类似但涉及指数运算。

## 常见问题转换
- **例题 UVa11526**：直接计算 ∑⌊n/i⌋，是 f(i)=1, g(x)=x 的特例。
- **区间贡献拆分**：如 Codeforces 1954E，将 max(0, ⌈aᵢ/k⌉ - ⌈aᵢ₋₁/k⌉) 的修改通过二维数论分块拆成 O(√aᵢ₋₁ + √aᵢ) 段区间加，用差分维护。