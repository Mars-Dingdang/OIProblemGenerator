## 关键观察与技巧

1. **误差控制**：普通辛普森法的误差与区间长度的五次方成正比，与函数的四阶导数有关。自适应方法通过递归细分高曲率区域来平衡精度与效率。

2. **自适应策略**：核心思想是“分而治之”。比较整个区间的辛普森近似值与将其分成两半后的近似值之和。如果差值在容差内（通常乘以安全系数15），则接受；否则递归细分。

3. **强制最小迭代**：在自适应实现中，通常强制执行一个最小递归深度（如12层），以避免过早终止在平坦但宽的区域。

4. **处理奇异点**：如果被积函数在端点或区间内有奇点（如趋于无穷），需要特殊处理，例如变换变量或拆分区间。

5. **精度与效率权衡**：自适应方法在函数平滑处用较少计算，在变化剧烈处自动加密，比均匀分段更高效。

6. **常见变换**：
   - **无穷区间积分**：通过变量替换（如 x = 1/t）转换为有限区间。
   - **振荡函数**：考虑分段积分或使用专门方法（如 Filon 积分）。
   - **多维积分**：可嵌套辛普森法，但维度诅咒使计算量指数增长，通常用蒙特卡洛方法替代。

7. **实现细节**：
   - 函数 `f(x)` 应尽可能高效，因为会被频繁调用。
   - 递归实现时注意栈深度，可改为迭代栈避免溢出。
   - 容差 `eps` 通常取 1e-6 到 1e-12，依需求而定。

8. **验证方法**：可通过与已知解析解比较，或对比不同分段数/容差的结果来验证正确性。