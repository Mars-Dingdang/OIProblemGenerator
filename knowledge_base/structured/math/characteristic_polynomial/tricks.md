## 关键观察与技巧

### 1. 相似变换不改变特征多项式
- 若 $B = P^{-1}AP$，则 $\det(\lambda I - A) = \det(\lambda I - B)$。
- 因此可以通过相似变换将矩阵化为容易计算的形式（如上三角、Hessenberg 矩阵）。

### 2. Hessenberg 算法的递推公式
对于上 Hessenberg 矩阵 $H$，记 $p_i(\lambda) = \det(\lambda I_i - H_i)$，其中 $H_i$ 是 $H$ 的前 $i$ 阶主子矩阵，则有递推：
$$p_i(\lambda) = (\lambda - \alpha_i)p_{i-1}(\lambda) - \sum_{m=1}^{i-1} h_{i-m,i}\left(\prod_{j=i-m+1}^i \beta_j\right)p_{i-m-1}(\lambda)$$
其中 $\alpha_i$ 是主对角线元素，$\beta_j$ 是次对角线元素。

### 3. 特征多项式的性质
- 常数项：$(-1)^n \det(A)$。
- $\lambda^{n-1}$ 的系数：$-\operatorname{tr}(A)$（迹）。
- 特征值之和 = 迹，特征值之积 = 行列式。

### 4. Cayley-Hamilton 定理的应用
- 若 $f(\lambda)$ 是 $A$ 的特征多项式，则 $f(A) = 0$。
- 可用于矩阵幂的降阶：$A^k$ 可表示为 $I, A, \dots, A^{n-1}$ 的线性组合。

### 5. 最小多项式与特征多项式的关系
- 最小多项式 $m_A(\lambda)$ 整除特征多项式 $f(\lambda)$。
- 两者有相同的根（不计重数）。
- 若矩阵可对角化，则最小多项式无重根。

### 6. 特征值加速递推
- 对于线性递推 $x_{n} = c_1 x_{n-1} + \dots + c_k x_{n-k}$，可构造友矩阵 $C$，其特征多项式为 $\lambda^k - c_1\lambda^{k-1} - \dots - c_k$。
- 利用特征值可快速计算 $C^n$，从而得到 $x_n$ 的闭式。

### 7. 模意义下的处理
- 算法支持模素数或合数（使用类似辗转相除的方法）。
- 注意模运算中负数的处理：`(x % mod + mod) % mod`。

### 8. 验证特征多项式
- 随机生成向量 $v$，验证 $f(A)v = 0$（Schwartz–Zippel 思想）。
- 概率性正确，但实际中非常可靠。

### 9. 特征向量的计算
- 对每个特征值 $\lambda$，解齐次线性方程组 $(\lambda I - A)X = 0$。
- 基础解系即为属于 $\lambda$ 的特征向量空间的一组基。

### 10. 矩阵相似与等价
- 相似 ⇒ 等价（秩相同），但等价 ⇏ 相似。
- 相似矩阵有相同的特征多项式、迹、行列式、特征值。