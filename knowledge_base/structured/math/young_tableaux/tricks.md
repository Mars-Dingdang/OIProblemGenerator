# 浅谈杨氏矩阵在信息学竞赛中的应用

**Author:** 袁方舟

### 关键思想与技巧

#### 1. **RSK 算法与排列的对应**
- **插入算法 `S ← x`**：将数字 `x` 插入杨表第一行，找到第一个大于 `x` 的元素 `y`，用 `x` 替换 `y`，并将 `y` 向下一行继续插入；若无更大元素，则将 `x` 放在行末。
- **对列插入 `x → S`**：类似地从第一列开始插入。
- **删除算法**：从边角 `(s,t)` 开始删除，向上查找最大小于当前值的元素进行替换，是插入的逆过程。
- **Robinson–Schensted 对应**：每个排列 `X` 唯一对应一对同形状的标准杨表 `(P_X, Q_X)`，其中 `P_X` 是通过 RSK 插入得到的，`Q_X` 记录插入位置的下标。这建立了排列与杨表之间的双射，从而有：
  
  $$
  \sum_{\lambda \vdash n} f_\lambda^2 = n!
  $$

#### 2. **最长上升/下降子序列 (LIS/LDS)**
- **定理5.1**：排列 `X` 的 LIS 长度等于其杨表 `P_X` 第一行的长度。
- **定理5.2**：LDS 长度等于 `P_X` 第一列的长度。这是通过对原序列翻转并利用行列交换性质得出的。
- **推广到 k-LIS**：前 `k` 列的总长度等于最长的 `k-LIS` 子序列长度（即该子序列的 LIS ≤ k）。这由引理5.4中构造规范形式 `X*` 并归纳得证。

#### 3. **钩子公式 (Hook-Length Formula)**
- 对于整数划分 `λ ⊢ n`，形状为 `λ` 的标准杨表个数为：
  $$
  f_\lambda = \frac{n!}{\prod_{(i,j) \in \lambda} h_\lambda(i,j)}
  $$
  其中 `h_λ(i,j)` 是钩长，即位于 `(i,j)` 的格子向右和向下（包括自身）能到达的所有格子数。
- **证明思路**：使用数学归纳法结合钩游走（Hook Walk）的概率模型，或通过代数恒等式（如利用内容差 `ct(c)=i-j` 和边界点求和）完成证明。

#### 4. **与网格路径的联系（Lindström–Gessel–Viennot 引理）**
- **非交叉路径计数**：给定起点集 `A_i` 和终点集 `E_j` 满足单调性条件，不相交路径组的数量为：
  $$
  \det(f(A_i \to E_j))
  $$
- **与杨表的双射**：一个半标准杨表可以映射为一组从 `(-i,1)` 到 `(λ_i - i, n)` 的不相交路径，每条路径代表一行，右移表示填入当前纵坐标值。由此导出 Aitken 公式和 Frobenius 行列式公式用于斜杨表计数。

#### 5. **对称矩阵与对合排列**
- 一个对称 `0-1` 矩阵（即对合排列）对应的杨表满足 `P_X = Q_X`。
- 因此，大小为 `n` 的标准杨表数目等于对合排列数（involution number），满足递推：
  $$
  a(n) = a(n-1) + (n-1)a(n-2)
  $$
- 迹 `tr(M)` 等于对应杨表中奇数长度列的数量。

#### 6. **半标准杨表计数公式**
- 数值在 `[1,n]` 内的半标准杨表个数为：
  $$
  s_\lambda = \prod_{(i,j) \in \lambda} \frac{n + j - i}{h_\lambda(i,j)}
  $$
  或等价于：
  $$
  s_\lambda = \prod_{1 \leq i < j \leq n} \frac{\lambda_i - \lambda_j + j - i}{j - i}
  $$
- 该公式可通过 Gelfand–Tsetlin 图案建立双射后，利用交错多项式和范德蒙德行列式的性质证明。

#### 7. **生成函数与特殊数列**
- **卡特兰数**：`2×n` 形状的标准杨表数为第 `n` 个卡特兰数 `C_n = \frac{1}{n+1}\binom{2n}{n}`。
- **Gessel-Bessel 恒等式**：LIS ≤ k 的排列数 `u_k(n)` 的指数生成函数为贝塞尔函数构成的行列式：
  $$
  U_k(x) = \det(I_{i-j}(2x))_{i,j=1}^k
  $$
  可用于高效计算小 `k` 下的计数问题。

#### 8. **实际应用技巧**
- **CTSC2017 最长上升子序列**：维护前缀杨表，利用前 `√n` 行/列分块处理，结合翻转技巧实现 `O(n√n log n)` 在线查询。
- **BJWC2018 LIS 期望**：枚举所有整数拆分 `λ ⊢ n`，使用钩子公式计算 `f_λ`，再根据第一行长度加权求和，复杂度远优于状压DP。
- **CodeChef BillBoards**：将约束转化为半标准杨表计数问题，直接套用公式解决大规模输入。