## 关键观察
- **交换律、结合律、分配律**：Dirichlet 卷积满足这些代数性质，单位元为 ε(n) = [n=1]。
- **积性函数封闭性**：若 f 和 g 为积性函数，则 f∗g 也为积性函数；且若 f(1)≠0，其逆元 f^{-1} 存在且也为积性函数。
- **完全积性函数性质**：若 α 为完全积性函数，则 (αf)∗(αg) = α·(f∗g)，且 (αf)^{-1} = αf^{-1}。
- **常见卷积恒等式**：
  - ε = μ∗1（莫比乌斯反演基础）
  - τ = 1∗1（约数个数）
  - σ = id∗1（约数和）
  - φ = id∗μ（欧拉函数）
- **Dirichlet 生成函数**：卷积对应生成函数乘积，便于推导恒等式（如 φ∗1 = id）。

## 优化技巧
- **一般情形 O(n log n)**：直接枚举因子对 (k, d) 满足 k*d ≤ n。
- **若 g 为积性函数 O(n log log n)**：利用 Euler 乘积，仅对素数幂进行卷积（类似埃氏筛复杂度）。
- **若结果 h 为积性函数 O(n)**：通过线性筛，仅需计算素数幂处 h(p^e) 值（暴力 O(e)），再积性递推。
- **特殊函数加速**：当 g=1 或 g=μ 时，可使用 Dirichlet 前缀和/差分算法（O(n log log n) 但常数更小）。

## 问题转化模式
- **前缀和问题**：杜教筛中，寻找 g 使 f∗g 和 g 前缀和易算，利用生成函数辅助构造（如 f(n)=n²φ(n) 取 g=id² 得 f∗g=id³）。
- **函数表示**：将目标函数表示为已知函数的 Dirichlet 卷积（如 σ_k = id_k∗1）。
- **逆元递推**：f^{-1}(n) = (ε(n) - Σ_{kℓ=n, k≠1} f(k)f^{-1}(ℓ)) / f(1)，用于递归计算逆元。