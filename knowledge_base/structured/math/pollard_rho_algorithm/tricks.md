## 关键观察
- **核心思想**：利用随机自映射函数在模 p 下的循环性质（ρ 形），通过检测碰撞找到非平凡因子。
- **生日悖论**：期望 O(√p) 步内出现碰撞，其中 p 是 N 的最小素因子。
- **函数选择**：常用 f(x) = (x² + c) mod N，c ≠ 0, -2，确保伪随机性和自映射性质。

## 优化技巧
1. **判环算法**
   - **Floyd 判环**：双指针（快慢指针），简单但常数较大。
   - **Brent 判环**：倍增跳跃，平均比 Floyd 快 24%。
2. **倍增优化**
   - 累积多个 |x_i - x_j| 的乘积，每 127 步（或其他块大小）计算一次 gcd，减少 gcd 调用次数。
   - 若乘积 mod N 为 0，说明分解失败，应更换 c 重试。
3. **结合 Miller-Rabin**
   - 先用 Miller-Rabin 判断素数，若为素数直接返回。
   - 递归分解因子，可求最大素因子或完整质因数分解。
4. **快速乘与快速幂**
   - 对于大整数（> 64 位），需用 `__int128` 或分治乘法避免溢出。
   - 示例中的 `bmul` 用浮点技巧实现 O(1) 快速乘（需注意精度）。

## 常见问题转换
- **求最大素因子**：递归分解，用 Miller-Rabin 判断素数并更新最大值。
- **判断是否为素数**：先用 Miller-Rabin，若为合数再用 Pollard-Rho 找因子验证。
- **分解完全平方数**：特判 N=4，并注意平方因子可能被遗漏，可结合试除法。

## 注意事项
- **随机种子**：使用 `srand(time(0))` 确保随机性。
- **失败处理**：若返回 N 本身，应更换 c 重新尝试。
- **小因子优化**：可先试除小素数（如前 1000 个素数）加速。
- **复杂度**：期望 O(N^{1/4})，但实际运行很快，最坏情况可能退化为 O(√N)。