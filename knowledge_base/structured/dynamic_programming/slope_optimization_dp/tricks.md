## 核心思想
将 DP 转移方程转化为 **最小化直线截距** 的形式：
`b[i] = min_{j<i} (y[j] - k[i] * x[j])`
其中 `(x[j], y[j])` 只与决策 `j` 有关，`k[i]` 只与当前状态 `i` 有关。

## 关键观察
1. **几何意义**：每个决策 `j` 对应平面上的点 `(x_j, y_j)`。最优决策是斜率为 `k_i` 的直线从下往上平移时 **第一个碰到的点**，该点一定在 **下凸壳** 上。
2. **单调性分类**：
   - **斜率 `k_i` 单调**：可用单调队列维护凸包，队首弹出劣决策，队尾维护凸性。
   - **横坐标 `x_j` 单调**：新决策点按序加入凸包尾部。
   - **两者均单调**：复杂度 `O(n)`。
   - **任一不单调**：需二分/CDQ/平衡树，复杂度 `O(n log n)`。

## 优化技巧
- **避免浮点数**：比较斜率时用乘法交叉判断，例如 `(y2-y1)*(x3-x2) <= (y3-y2)*(x2-x1)` 代替除法。
- **初始化**：通常加入原点 `(x[0], y[0])` 作为初始决策。
- **CDQ 分治**：
  - 先递归左半区间计算 DP 值。
  - 用左区间构建静态凸包，按 `k_i` 排序右区间后更新。
  - 递归右区间。
  - 需额外归并排序保证 `x` 或 `k` 有序。
- **平衡树**：动态维护凸包，支持任意顺序插入删除，实现较复杂但通用。

## 常见变换模式
1. **平方代价**：`(sum - C)^2` 形式可直接套用。
2. **分离变量**：将转移式展开，分离出只含 `i`、只含 `j`、交叉项 `i*j` 三部分。
3. **参数定义**：令 `s[i] = pre[i] + i` 等偏移量简化表达式。
4. **符号处理**：注意斜率符号，有时需最大化截距或维护上凸壳。

## 注意事项
- 凸包维护的是 **下凸壳**（最小化截距）还是 **上凸壳**（最大化截距）取决于目标。
- 当横坐标相等时需特判，避免除零。
- 在 CDQ 中，若 `k_i` 不单调，需在凸包上二分查找最优决策点。