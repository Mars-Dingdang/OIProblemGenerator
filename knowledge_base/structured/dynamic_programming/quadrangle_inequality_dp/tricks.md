## 核心观察
- **四边形不等式（交叉小于包含）**：若 w(a,c)+w(b,d) ≤ w(a,d)+w(b,c) 对所有 a≤b≤c≤d 成立，则决策单调性成立。
- **决策单调性**：opt(i) 单调不减，可将决策空间从 O(n²) 降至 O(n log n)。

## 算法选择指南
| w(j,i) 性质 | 推荐算法 | 备注 |
|-------------|----------|------|
| 随机访问 O(1) | 分治法 | 实现简单，递归 O(n log n) |
| 动态计算（依赖 f(j')） | 二分队列法 | 顺序处理，支持依赖前状态 |
| 移动访问（莫队式） | 简化 LARSCH | 游标移动，O(n log n) 移动次数 |
| 动态+移动 | 简化 LARSCH | 唯一同时支持两种限制的算法 |

## 区间分割问题特化
- **1D/1D DP**：f(i) = min_{j≤i} f(j-1) + w(j,i)，若 w 满足四边形不等式，则可用二分队列/LARSCH。
- **限制段数 m**：f(k,i) = min_{j≤i} f(k-1,j-1) + w(j,i)。额外性质：opt(k-1,i) ≤ opt(k,i) ≤ opt(k,i+1)，可优化至 O(n(n+m))。
- **凸性**：最优解 g(k)=f(n,k) 关于段数 k 是凸函数，可用于 wqs 二分等进一步优化。

## 实现技巧
- **二分队列**：维护三元组 (决策 j, 左端点 l_j, 右端点 r_j)，保证队列中决策的区间严格递增。
- **分治递归**：每次先求中点 mid 的最优决策，利用单调性缩小左右子问题的决策区间。
- **边界处理**：注意等号情况，通常定义“更优”为 (值更小) 或 (值相等且决策点更小)。

## 经典问题转化
- **POI2011 Lightning Conductor**：f(i) = max_j { a_j + sqrt(|i-j|) } - a_i，利用 -sqrt(x) 的凸性证明四边形不等式。
- **区间分割**：将序列分成若干连续段，每段代价 w(l,r)，求最小总代价。
- **带权区间覆盖**：类似区间分割，但 w(l,r) 可能表示覆盖 [l,r] 的代价。