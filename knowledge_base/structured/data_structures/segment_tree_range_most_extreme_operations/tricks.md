- **关键观察**：区间取 min/max 操作只影响部分元素（大于 x 的才被 min 更新，小于 x 的才被 max 更新），因此可以利用最大值、次大值、最小值、次小值进行剪枝。
- **势能分析**：每个数被修改的次数有限（例如被 min 修改时只能变小，且每次至少变为更小的值），结合线段树分治可得复杂度为 $ O(m \log^2 n) $。
- **标记合并顺序**：先处理加法标记，再处理 min/max 标记；min 和 max 标记互不干扰，但需注意更新对方的标记（如对 min 标记更新时，若其值小于当前 max 标记，则应覆盖 max 标记）。
- **信息分类维护**：将区间内元素分为“最大值”、“最小值”、“中间值”，分别维护个数与和，便于快速更新。
- **特判重复极值**：当最大值等于最小值或次大值等于最大值时，需特殊处理以避免错误下传。
- **辅助数组同步更新**：在执行主数组操作的同时，可在打标记或下传时同步更新另一个数组（如 B 数组记录修改次数），实现联动维护。
- **多维状态合并**：对于复合问题（如 $ \max(a_i + b_i) $），可将状态按是否为各自序列极值分为四类 $ C_{0,0}, C_{1,0}, C_{0,1}, C_{1,1} $，并在 pushup 中分类讨论贡献。