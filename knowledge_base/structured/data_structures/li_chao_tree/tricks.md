- **标记永久化**：不进行下传，查询时遍历所有覆盖区间的标记并取最优。
- **中点比较法**：插入时通过中点函数值决定保留哪条线段作为当前节点标记，并根据端点判断递归方向。
- **避免浮点误差**：使用 `eps` 进行比较，防止精度问题导致错误分支。
- **垂直线段处理**：当线段垂直于 x 轴时，将其视为常数函数 $ f(x) = \max(y_0, y_1) $，定义域为单点区间。
- **合并优化**：多棵树合并时，采用动态开点并将一棵树中的每条线段插入到另一棵树中，总复杂度 $ O(n \log n) $。
- **强制在线处理**：输入坐标需结合上一次答案进行解码，注意模运算与边界调整。
- **懒标记非最优点**：每个节点的标记不一定是在该区间中点最优的线段，仅用于辅助更新和查询。