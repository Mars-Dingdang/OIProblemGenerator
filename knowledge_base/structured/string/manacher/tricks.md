## 关键观察
- **对称性利用**：维护当前最右回文边界 `(l, r)`，对于 `i <= r`，利用对称点 `j = l + r - i` 的已知半径 `d1[j]` 快速初始化 `d1[i]`，避免重复比较。
- **边界处理**：当对称点的回文扩展到当前边界外时（即 `j - d1[j] + 1 <= l`），只能截断到 `r - i + 1`，然后继续朴素扩展。
- **线性复杂度证明**：每次朴素扩展都会增加 `r`，且 `r` 单调不减，因此总扩展次数为 O(n)。

## 优化技巧
- **统一处理奇偶长度**：在原字符串每个字符间及两端插入分隔符（如 `#`），将奇偶回文统一为奇数回文处理，简化代码。转换后字符串长度为 `2n+1`，半径 `d1[i]` 与原串关系为：原串中以位置 `i` 为中心的回文总长度 = `d1[i] - 1`。
- **避免字符串拷贝**：若只需统计数量或最长回文，可在原串上直接计算，无需构造新串。
- **空间优化**：`d1` 和 `d2` 数组可复用，或只保留当前需要的部分。

## 常见问题转换
- **最长回文子串**：遍历 `d1` 和 `d2` 找到最大半径，即可得起始位置和长度。
- **回文子串计数**：`d1[i]` 和 `d2[i]` 分别表示以 `i` 为中心的奇/偶回文个数，求和即得总数。
- **周期性回文**：若字符串具有周期 `p`，可利用 Manacher 结果快速判断任意子串是否为回文。
- **结合其他数据结构**：与后缀数组、哈希结合，可处理更复杂的回文匹配问题（如 CF235C Cyclical Quest）。

## 注意事项
- **下标处理**：算法中 `d1[i]` 定义为半径（包含中心），因此实际回文长度为 `2 * d1[i] - 1`。偶数回文类似。
- **初始化**：`r = -1` 确保第一个字符 `i=0` 进入朴素扩展分支。
- **字符集扩展**：若字符串包含非小写字母，需调整字符映射或直接比较字符。